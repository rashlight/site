{{ $target := resources.Get .path }}
{{ $scratchJs := newScratch }}
{{ if hugo.IsProduction }}
  {{ $scratchJs.Set "scriptJs" ($target | minify | fingerprint) }}
{{ else }}
  {{ $scratchJs.Set "scriptJs" $target }}
{{ end }}

{{ if and .defer .async }}
  {{ warnidf "warn-js-defer-async" "One or more Javascript tags have defer and async at the same time. async will be used." }}
{{ end }}

{{ if .async }}
  {{ $targetJs := $scratchJs.Get "scriptJs" }}
  <script src="{{ $targetJs.RelPermalink }}" async></script>
{{ else if .defer }}
  {{ $targetJs := $scratchJs.Get "scriptJs" }}
  <script src="{{ $targetJs.RelPermalink }}" defer></script>
{{ else }} {{/* render-blocking */}}
  {{ $targetJs := $scratchJs.Get "scriptJs" }}
  <script src="{{ $targetJs.RelPermalink }}"></script>
{{ end }}
